# ===================================================================
# ARQUIVO .HTACCESS MELHORADO E CORRIGIDO
# ===================================================================

# === MELHORIAS DE SEGURANÇA ===

# 1. Impede que as pessoas possam listar o conteúdo das suas pastas
Options -Indexes

# === MELHORIAS DE PERFORMANCE (CACHE DO NAVEGADOR) ===
# Diz ao navegador do visitante para guardar cópias de arquivos estáticos,
# fazendo o site carregar muito mais rápido em visitas futuras.
<IfModule mod_expires.c>
  ExpiresActive On
  ExpiresByType image/jpg "access plus 1 year"
  ExpiresByType image/jpeg "access plus 1 year"
  ExpiresByType image/gif "access plus 1 year"
  ExpiresByType image/png "access plus 1 year"
  ExpiresByType image/svg+xml "access plus 1 year"
  ExpiresByType text/css "access plus 1 month"
  ExpiresByType application/javascript "access plus 1 month"
  ExpiresByType application/x-javascript "access plus 1 month"
</IfModule>


# === REGRAS DE REESCRITA (URLS AMIGÁVEIS) ===

RewriteEngine On
RewriteBase /IsabellaAtacadista/

# Redireciona o acesso direto à pasta para a página "home"
RewriteRule ^$ index.php?page=home [L]

# **A CORREÇÃO PRINCIPAL ESTÁ AQUI**
# Redireciona URLs com .php para sem .php, mas IGNORA requisições de formulário (POST)
# para não perder os dados enviados.
RewriteCond %{REQUEST_METHOD} !POST
RewriteCond %{THE_REQUEST} \s/+(.+?)\.php[\s?] [NC]
RewriteRule ^ /IsabellaAtacadista/%1 [R=301,L]

# Pega uma URL "bonita" (sem .php) e a reescreve internamente
# para que o servidor entenda qual arquivo carregar.
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}.php -f
RewriteRule ^(.+)$ $1.php [L,QSA]

# Regra final do Roteador (Front Controller):
# Se o arquivo ou diretório não existir, manda para o index.php.
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php?page=$1 [QSA,L]


# === PÁGINA DE ERRO PERSONALIZADA ===
ErrorDocument 404 /IsabellaAtacadista/erro404.php